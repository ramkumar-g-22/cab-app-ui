<!DOCTYPE html>
<html>

<head>
	<meta charset="ISO-8859-1">
	<title>Booking Cab</title>
	<script src="cabTypeManager.js"></script>
	<script src="price-estimator.js"></script>
</head>

<body>
	<h2>Booking Cab</h2>
	<form action="">

		<select required id="cabType">
			<option disabled selected>-- select cab type</option>
			<option value="Micro">Micro</option>
			<option value="Mini">Mini</option>
			<option value="Prime">Prime</option>
		</select>
		<br>

		<input min="1" type="number" placeholder="Enter km" name="kilometer" id="kilometer">
		<br>

		<p>Total fare without GST : Rs.
			<span id="totalFarePriceWithoutGST">0</span>
		</p>
		<p>Total fare with GST : Rs.
			<span id="totalFarePriceWithGST">0</span>
		</p>

		<label for="dateOfBirth">Enter date of birth : </label>
		<input type="date" name="dateOfBirth" id="dateOfBirth" max="2021-04-19">
		<br>
		<label for="journeyDate">Enter journey date : </label>
		<input min="2021-04-19" max="2021-04-26" name="journeyDate" id="journeyDate" type="date">
		<br>
		<label for="pickupTime">Enter pickup time : </label>
		<input name="pickupTime" id="pickupTime" type="time">
		<br>
		<p>Total fare at peak time with GST : Rs.
			<span id="totalFarePriceAtPeakTime">0</span>
		</p>
		<br>
		<input type="checkbox" name="seniorCitizen" id="seniorCitizen">
		<label for="seniorCitizen">Are you senior citizen?</label>
		<p>Total fare price for senior citizen : Rs. <span id="farePriceForSeniorCitizen">0</span> </p>
		<br>
		<button>Submit</button>
	</form>

	<script>
		var cabType = "";
		var cabTypeFarePrice = 0;
		var kilometer = 0;
		var isValidKilometer = false;
		var totalFarePriceWithoutGST;
		var totalFarePriceWithGST;
		var dateOfBirth = "";
		var journeyDate = "";
		var pickupTime = "";
		var age;
		var currentYear;
		var birthYear;
		var pickupHour;
		var totalFarePriceAtPeakTime;
		var isSeniorCitizen;
		var totalFareForSeniorCitizen = 0;

		document.getElementById("cabType").onchange = function () {
			cabType = getCabType();
			calculateTotalFare();
		}

		document.getElementById("kilometer").onchange = function () {
			kilometer = getKilometer();
			calculateTotalFare();
		}

		document.getElementById("dateOfBirth").onchange = () => {
			dateOfBirth = getDateOfBirth();
			age = getAge(dateOfBirth);
			console.log("Age : ", age);
		}

		document.getElementById("pickupTime").onchange = () => {
			pickupTime = getPickupTime();
			pickupHour = pickupTime.slice(0, 2);
			calculateTotalFare();
		}

		var seniorCitizen = document.getElementById("seniorCitizen");
		seniorCitizen.onchange = () => {
			isSeniorCitizen = seniorCitizen.checked;
			console.log(isSeniorCitizen);
			if (isSeniorCitizen && age > 65) {
				totalFareForSeniorCitizen = calculateTotalFareForSeniorCitizen(totalFarePriceWithGST);
				console.log(totalFareForSeniorCitizen);
				document.getElementById("farePriceForSeniorCitizen").innerHTML = totalFareForSeniorCitizen;
			}else{
				document.getElementById("farePriceForSeniorCitizen").innerHTML = 0;				
			}
		}

		function getAge(dateOfBirth) {
			var age;
			currentYear = new Date().getFullYear();
			birthYear = dateOfBirth.slice(0, 4);
			age = parseInt(currentYear) - parseInt(birthYear);
			return age;
		}

		function getDateOfBirth() {
			var dateOfBirth = document.getElementById("dateOfBirth").value;
			return dateOfBirth;
		}

		function getJourneyDate() {
			var journeyDate = document.getElementById("journeyDate").value;
			return journeyDate;
		}

		function getPickupTime() {
			var pickupTime = document.getElementById("pickupTime").value;
			return pickupTime;
		}

		function getKilometer() {
			var kilometer = document.getElementById("kilometer").value;
			return kilometer;
		}


		function calculateTotalFare() {
			cabTypeFarePrice = getCabTypeFarePrice(cabType);
			totalFarePriceWithoutGST = calculateTotalFarePriceWithoutGST(cabTypeFarePrice, kilometer);
			totalFarePriceWithGST = calculateTotalFarePriceWithGST(totalFarePriceWithoutGST);
			totalFarePriceAtPeakTime = calculateTotalFareAtPeakTime(pickupHour, totalFarePriceWithGST, kilometer);
			document.getElementById("totalFarePriceAtPeakTime").innerHTML = totalFarePriceAtPeakTime;
			document.getElementById("totalFarePriceWithoutGST").innerHTML = totalFarePriceWithoutGST;
			document.getElementById("totalFarePriceWithGST").innerHTML = totalFarePriceWithGST;
		}



	</script>

</body>

</html>